<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="logo.png">
    <title>Submit Item - BackTrack</title>
    <script>
        // Disable pulsing/flashing animations site-wide
        window.__DISABLE_ANIMATIONS__ = true;
    </script>
    <style>
        /* Disable CSS animations (stops pulsing/flashing indicators) but keep final states visible */
        * {
            animation: none !important;
            -webkit-animation: none !important;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/design-system.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/nav-auth.css">
    <style>
        a,
        button {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Navigation */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 40px;
            background-color: transparent;
            height: 70px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            transition: background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        nav::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.nav-scrolled nav {
            background-color: #000000;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        body.nav-scrolled nav::after {
            opacity: 1;
        }

        .nav-spacer {
            height: 70px;
        }

        .nav-left {
            display: flex;
            align-items: center;
            text-decoration: none;
            height: 100%;
        }

        .nav-left img {
            height: 70px;
            width: auto;
        }

        .nav-center {
            display: flex;
            gap: 48px;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.5);
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            transition: color 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-link:hover {
            color: rgba(255, 255, 255, 0.8);
        }

        .nav-link.active {
            color: #ffffff;
        }

        .nav-right {
            display: flex;
            align-items: center;
        }

        .sign-in-btn {
            position: relative;
            overflow: hidden;
            background: linear-gradient(180deg, #2e2e2e 0%, #1f1f1f 100%);
            color: #f3f4f6;
            border: 1px solid #3f3f3f;
            padding: 8px 18px;
            border-radius: 999px;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, color 0.35s ease, background 0.6s ease;
            letter-spacing: 0.4px;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.08);
            text-decoration: none;
            display: inline-block;
        }

        .sign-in-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -120%;
            width: 60%;
            height: 200%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            transform: skewX(-20deg);
            opacity: 0;
            transition: left 0.8s ease, opacity 0.4s ease;
        }

        .sign-in-btn:hover {
            transform: translateY(-1px);
            background: linear-gradient(180deg, #f5f5f5 0%, #d9d9d9 100%);
            color: #1a1a1a;
            box-shadow: 0 12px 26px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        .sign-in-btn:hover::before {
            left: 120%;
            opacity: 1;
        }

        .sign-in-btn:active {
            transform: translateY(0);
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.35);
        }

        /* User Avatar */
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            text-decoration: none;
        }

        .user-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Main Content */
        .main-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 50px 20px;
        }

        .page-title {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 12px;
            text-align: center;
            letter-spacing: -2px;
            background: linear-gradient(180deg, #ffffff 0%, #a0a0a0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-description {
            color: #666666;
            font-size: 17px;
            margin-bottom: 48px;
            text-align: center;
            line-height: 1.5;
        }

        /* Form */
        .submit-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 500;
            color: #ffffff;
        }

        .form-label .optional {
            color: #666666;
            font-weight: 400;
        }

        .form-input,
        .form-select,
        .form-textarea {
            background-color: #0f0f0f;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 14px 16px;
            color: #ffffff;
            font-size: 14px;
            font-family: inherit;
            outline: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            border-color: rgba(255, 255, 255, 0.2);
            background-color: #161616;
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.05);
        }

        .form-input::placeholder,
        .form-textarea::placeholder {
            color: #666666;
        }

        .form-select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23888888' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center;
            padding-right: 40px;
        }

        .form-select option {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Image Upload */
        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background-color: rgba(255, 255, 255, 0.02);
            min-height: 160px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .upload-area:hover {
            border-color: rgba(255, 255, 255, 0.3);
            background-color: rgba(255, 255, 255, 0.04);
            transform: translateY(-2px);
        }

        .upload-area.dragover {
            border-color: rgba(255, 255, 255, 0.5);
            background-color: rgba(255, 255, 255, 0.08);
        }

        .upload-icon {
            width: 40px;
            height: 40px;
            margin-bottom: 12px;
            color: #666666;
        }

        .upload-text {
            color: #888888;
            font-size: 14px;
        }

        .upload-input {
            display: none;
        }

        .image-preview {
            display: none;
            position: relative;
        }

        .image-preview img {
            width: 100%;
            height: 160px;
            object-fit: cover;
            border-radius: 8px;
        }

        .remove-image {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #ffffff;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Submit Button */
        .submit-btn {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: #ffffff;
            border: none;
            border-radius: 12px;
            padding: 16px 32px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            width: 100%;
            margin-top: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            box-shadow: 0 8px 30px rgba(37, 99, 235, 0.4);
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Success Message */
        .success-message {
            display: none;
            background-color: rgba(34, 197, 94, 0.1);
            border: 1px solid #22c55e;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            margin-bottom: 24px;
        }

        .success-message.show {
            display: block;
        }

        .success-message h3 {
            color: #22c55e;
            margin-bottom: 4px;
            font-size: 16px;
        }

        .success-message p {
            color: #888888;
            font-size: 14px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            nav {
                padding: 0 20px;
            }

            .nav-center {
                display: none;
            }

            .main-content {
                padding: 30px 20px;
            }

            .page-title {
                font-size: 28px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 20px 12px;
            }

            .page-title {
                font-size: 24px;
            }

            .submit-tab {
                padding: 10px 12px;
                font-size: 13px;
            }
        }

        /* Tab Navigation */
        .submit-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 36px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 14px;
            padding: 4px;
        }

        .submit-tab {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 11px;
            background: transparent;
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: inherit;
        }

        .submit-tab:hover {
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.03);
        }

        .submit-tab.active {
            background: rgba(255, 255, 255, 0.08);
            color: #ffffff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .submit-tab .tab-icon {
            font-size: 16px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* Urgency Select */
        .urgency-group {
            display: flex;
            gap: 10px;
        }

        .urgency-option {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: transparent;
            color: rgba(255, 255, 255, 0.5);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            font-family: inherit;
        }

        .urgency-option:hover {
            border-color: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.7);
        }

        .urgency-option.selected {
            border-color: rgba(37, 99, 235, 0.4);
            background: rgba(37, 99, 235, 0.08);
            color: #60a5fa;
        }

        .urgency-option[data-value="high"].selected {
            border-color: rgba(239, 68, 68, 0.4);
            background: rgba(239, 68, 68, 0.08);
            color: #fca5a5;
        }

        .urgency-option[data-value="medium"].selected {
            border-color: rgba(245, 158, 11, 0.4);
            background: rgba(245, 158, 11, 0.08);
            color: #fbbf24;
        }
    </style>
    <link rel="stylesheet" href="css/theme.css">
</head>

<body>
    <a href="#main-content" class="skip-to-content">Skip to main content</a>

    <!-- Page Transition Overlay -->
    <div class="page-transition" id="pageTransition"></div>

    <!-- Navigation -->
    <nav aria-label="Main navigation">
        <a href="index.html" class="nav-left">
            <span class="brand-logo">
                <img class="logo-dark" src="logo.png" alt="BackTrack">
                <img class="logo-light" src="logo-white.png" alt="" aria-hidden="true">
            </span>
        </a>

        <div class="nav-center">
            <a href="browse.html" class="nav-link">Browse</a>
            <a href="map.html" class="nav-link">Map</a>
            <a href="submit.html" class="nav-link active">Submit</a>
            <a href="rewards.html" class="nav-link">Rewards</a>
            <a href="features.html" class="nav-link">Features</a>
            <a href="sources.html" class="nav-link">Sources</a>
        </div>

        <div class="nav-right">
            <a class="sign-in-btn" href="login.html">Log In</a>
        </div>
    </nav>
    <div class="nav-spacer"></div>

    <main class="main-content" id="main-content">
        <h1 class="page-title">Submit</h1>
        <p class="page-description">Found something? Report it. Lost something? Post a bounty so others can help.</p>

        <!-- Tab Navigation -->
        <div class="submit-tabs" role="tablist">
            <button class="submit-tab active" data-tab="found" id="tabFound" role="tab" aria-selected="true"
                aria-controls="panelFound">
                <span class="tab-icon"><svg aria-hidden="true" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
                        <line x1="12" y1="22.08" x2="12" y2="12" />
                    </svg></span> Report Found Item
            </button>
            <button class="submit-tab" data-tab="bounty" id="tabBounty" role="tab" aria-selected="false"
                aria-controls="panelBounty">
                <span class="tab-icon"><svg aria-hidden="true" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="11" cy="11" r="8" />
                        <path d="M21 21l-4.35-4.35" />
                    </svg></span> Post a Bounty
            </button>
        </div>

        <div class="success-message" id="successMessage" role="status" aria-live="polite">
            <h3>Submission Sent for Review</h3>
            <p>Thanks for helping! An admin will review and approve this found item report before it appears on the live
                map.</p>
        </div>

        <div class="success-message" id="bountySuccessMessage" role="status" aria-live="polite">
            <h3>Bounty Sent for Review</h3>
            <p>Your lost item bounty has been submitted. It will appear live for others to help find it once an admin
                approves it.</p>
        </div>

        <!-- Found Item Tab -->
        <div class="tab-panel active" id="panelFound" role="tabpanel">
            <form class="submit-form" id="submitForm">
                <fieldset class="form-fieldset">
                    <legend class="sr-only">Item Details</legend>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="imageInput">Upload Photos</label>
                        <div class="upload-area" id="uploadArea">
                            <svg class="upload-icon" aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                <polyline points="21 15 16 10 5 21"></polyline>
                            </svg>
                            <p class="upload-text">Drag-and-drop in an image you<br>want photos here.</p>
                        </div>
                        <input type="file" class="upload-input" id="imageInput" accept="image/*">
                        <div class="image-preview" id="imagePreview">
                            <img src="" alt="Preview" id="previewImg">
                            <button type="button" class="remove-image" id="removeImage">
                                <svg aria-hidden="true" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="form-group" style="display: flex; flex-direction: column; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label" for="itemName">Item Name</label>
                            <input type="text" class="form-input" id="itemName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="itemDescription">Description</label>
                            <textarea class="form-textarea" id="itemDescription"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="itemCategory">Category</label>
                        <select class="form-select" id="itemCategory" required>
                            <option value="">Select Category</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Clothing">Clothing</option>
                            <option value="Bottles">Bottles</option>
                            <option value="Books">Books</option>
                            <option value="Accessories">Accessories</option>
                            <option value="Bags">Bags</option>
                            <option value="Keys">Keys</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="itemLocation">Location Found</label>
                        <select class="form-select" id="itemLocation" required>
                            <option value="">Select Category</option>
                            <option value="Front Office / Admin">Front Office / Admin</option>
                            <option value="Cafeteria">Cafeteria</option>
                            <option value="Media Center">Media Center</option>
                            <option value="Gymnasium">Gymnasium</option>
                            <option value="Classrooms">Classrooms</option>
                            <option value="Computer / Science Labs">Computer / Science Labs</option>
                            <option value="Art / Music Rooms">Art / Music Rooms</option>
                            <option value="Restrooms">Restrooms</option>
                            <option value="Athletic Fields / Track">Athletic Fields / Track</option>
                            <option value="Parking Lots / Bus Lot">Parking Lots / Bus Lot</option>
                            <option value="The Barn">The Barn</option>
                        </select>
                        <select class="form-select" id="itemLocationSpecific" style="display: none; margin-top: 12px;"
                            required>
                            <option value="">Select Specific Location</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="itemDate">Date & Time Found</label>
                        <input type="date" class="form-input" id="itemDate" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="finderName">Finder's Name/ID <span
                                class="optional">(Optional)</span></label>
                        <input type="text" class="form-input" id="finderName">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="contactEmail">Contact Email</label>
                        <input type="email" class="form-input" id="contactEmail" placeholder="you@school.edu" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="contactPhone">Contact Phone <span
                                class="optional">(Optional)</span></label>
                        <input type="tel" class="form-input" id="contactPhone" placeholder="(555) 123-4567">
                    </div>
                </div>

                </fieldset>
                <button type="submit" class="submit-btn" id="submitBtn">Submit for Review</button>
            </form>
        </div>

        <!-- Bounty Tab -->
        <div class="tab-panel" id="panelBounty" role="tabpanel">
            <form class="submit-form" id="bountyForm">
                <fieldset class="form-fieldset">
                    <legend class="sr-only">Bounty Details</legend>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="bountyImage">Photo of Similar Item <span
                                class="optional">(Optional)</span></label>
                        <div class="upload-area" id="bountyUploadArea">
                            <svg class="upload-icon" aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                <polyline points="21 15 16 10 5 21"></polyline>
                            </svg>
                            <p class="upload-text">Upload a photo of what<br>your item looks like</p>
                        </div>
                        <input type="file" class="upload-input" id="bountyImageInput" accept="image/*">
                        <div class="image-preview" id="bountyImagePreview">
                            <img src="" alt="Preview" id="bountyPreviewImg">
                            <button type="button" class="remove-image" id="bountyRemoveImage">
                                <svg aria-hidden="true" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="form-group" style="display: flex; flex-direction: column; gap: 16px;">
                        <div class="form-group">
                            <label class="form-label" for="bountyName">What did you lose?</label>
                            <input type="text" class="form-input" id="bountyName" placeholder="e.g. Blue Nike Backpack"
                                required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="bountyDescription">Description</label>
                            <textarea class="form-textarea" id="bountyDescription"
                                placeholder="Describe your item in detail â€” color, brand, distinguishing marks..."></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="bountyCategory">Category</label>
                        <select class="form-select" id="bountyCategory" required>
                            <option value="">Select Category</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Clothing">Clothing</option>
                            <option value="Bottles">Bottles</option>
                            <option value="Books">Books</option>
                            <option value="Accessories">Accessories</option>
                            <option value="Bags">Bags</option>
                            <option value="Keys">Keys</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="bountyLocation">Where did you last have it?</label>
                        <select class="form-select" id="bountyLocation" required>
                            <option value="">Select Category</option>
                            <option value="Front Office / Admin">Front Office / Admin</option>
                            <option value="Cafeteria">Cafeteria</option>
                            <option value="Media Center">Media Center</option>
                            <option value="Gymnasium">Gymnasium</option>
                            <option value="Classrooms">Classrooms</option>
                            <option value="Computer / Science Labs">Computer / Science Labs</option>
                            <option value="Art / Music Rooms">Art / Music Rooms</option>
                            <option value="Restrooms">Restrooms</option>
                            <option value="Athletic Fields / Track">Athletic Fields / Track</option>
                            <option value="Parking Lots / Bus Lot">Parking Lots / Bus Lot</option>
                            <option value="The Barn">The Barn</option>
                        </select>
                        <select class="form-select" id="bountyLocationSpecific" style="display: none; margin-top: 12px;"
                            required>
                            <option value="">Select Specific Location</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="bountyDate">Date Lost</label>
                        <input type="date" class="form-input" id="bountyDate" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Urgency</label>
                        <div class="urgency-group">
                            <button type="button" class="urgency-option selected" data-value="low">Low</button>
                            <button type="button" class="urgency-option" data-value="medium">ðŸŸ¡ Medium</button>
                            <button type="button" class="urgency-option" data-value="high">ðŸ”´ High</button>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="bountyEmail">Your Email</label>
                        <input type="email" class="form-input" id="bountyEmail" placeholder="you@school.edu" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="bountyPhone">Phone <span
                                class="optional">(Optional)</span></label>
                        <input type="tel" class="form-input" id="bountyPhone" placeholder="(555) 123-4567">
                    </div>
                </div>

                </fieldset>
                <button type="submit" class="submit-btn" id="bountySubmitBtn">Post Bounty</button>
            </form>
        </div>
    </main>

    <!-- Chatbot Widget -->
    <style>
        .chatbot-widget {
            position: fixed;
            right: 24px;
            bottom: 24px;
            z-index: 200;
            font-family: inherit;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(145deg, #1a1a1a 0%, #0a0a0a 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            animation: popIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 1s backwards;
            position: relative;
            overflow: hidden;
        }

        .chatbot-toggle::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.08) 0%, transparent 60%);
            pointer-events: none;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: scale(0);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .chatbot-toggle:hover {
            transform: scale(1.08) translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .chatbot-toggle:active {
            transform: scale(0.95);
        }

        .chatbot-toggle svg {
            width: 28px;
            height: 28px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .chatbot-panel {
            position: absolute;
            right: 0;
            bottom: 70px;
            width: 320px;
            max-height: 440px;
            display: none;
            flex-direction: column;
            background: #0d0d0d;
            border: 1px solid #1a1a1a;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transform: translateY(10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .chatbot-panel.open {
            display: flex;
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .chatbot-header {
            padding: 14px 16px;
            border-bottom: 1px solid #1a1a1a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-title {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 0.4px;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: #8a8a8a;
            cursor: pointer;
            font-size: 18px;
        }

        .chatbot-messages {
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow-y: auto;
            max-height: 280px;
        }

        .chatbot-message {
            font-size: 13px;
            line-height: 1.4;
            padding: 10px 12px;
            border-radius: 12px;
            background: #141414;
            color: #e5e5e5;
        }

        .chatbot-message.user {
            align-self: flex-end;
            background: #202020;
            color: #ffffff;
        }

        .chatbot-footer {
            border-top: 1px solid #1a1a1a;
            padding: 12px;
            display: flex;
            gap: 8px;
        }

        .chatbot-input {
            flex: 1;
            background: #0f0f0f;
            border: 1px solid #262626;
            border-radius: 10px;
            color: #ffffff;
            padding: 10px 12px;
            font-size: 13px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .chatbot-input:focus {
            outline: none;
            border-color: #404040;
            background: #161616;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.05);
        }

        .chatbot-send {
            background: #ffffff;
            color: #111111;
            border: none;
            padding: 10px 12px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .chatbot-send:hover {
            background: #e8e8e8;
            transform: scale(1.05);
        }

        .chatbot-send:active {
            transform: scale(0.95);
        }

        .chatbot-hint {
            color: #7a7a7a;
            font-size: 12px;
            padding: 0 16px 14px;
        }

        .chatbot-status {
            min-height: 16px;
            padding: 0 16px 10px;
            font-size: 12px;
            color: #6f6f6f;
        }

        .chatbot-status.error {
            color: #fca5a5;
        }

        @media (max-width: 768px) {
            .chatbot-widget {
                right: 16px;
                bottom: 16px;
            }

            .chatbot-panel {
                width: 280px;
            }
        }
    </style>

    <div class="chatbot-widget">
        <button class="chatbot-toggle" id="chatbotToggle" aria-label="Open chat assistant">
            <svg viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"
                stroke-linejoin="round" aria-hidden="true">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                <circle cx="9" cy="10" r="1" fill="#ffffff" />
                <circle cx="12" cy="10" r="1" fill="#ffffff" />
                <circle cx="15" cy="10" r="1" fill="#ffffff" />
            </svg>
        </button>
        <div class="chatbot-panel" id="chatbotPanel">
            <div class="chatbot-header">
                <div class="chatbot-title">BackTrack Assistant</div><button class="chatbot-close"
                    id="chatbotClose">&times;</button>
            </div>
            <div class="chatbot-messages" id="chatbotMessages">
                <div class="chatbot-message">Ask me about BackTrack's features, how to submit items, or how browsing
                    works.</div>
            </div>
            <div class="chatbot-hint">Questions outside the website won't be answered.</div>
            <div class="chatbot-status" id="chatbotStatus"></div>
            <div class="chatbot-footer"><input class="chatbot-input" id="chatbotInput" type="text"
                    placeholder="Ask about BackTrack..." /><button class="chatbot-send" id="chatbotSend">Send</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer style="padding: 60px 80px 40px; border-top: 1px solid rgba(255,255,255,0.06);">
        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 48px; margin-bottom: 48px;">
            <div>
                <div style="font-size: 18px; font-weight: 700; margin-bottom: 12px;">BackTrack</div>
                <p style="color: #888888; font-size: 14px; line-height: 1.6; max-width: 280px;">A centralized
                    lost-and-found system for students and staff. Built for FBLA Coding & Programming.</p>
            </div>
            <div>
                <div
                    style="font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: #888888; margin-bottom: 16px;">
                    Product</div>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <a href="browse.html" style="color: #777777; text-decoration: none; font-size: 14px;">Browse
                        Items</a>
                    <a href="submit.html" style="color: #777777; text-decoration: none; font-size: 14px;">Submit
                        Item</a>
                    <a href="claim.html" style="color: #777777; text-decoration: none; font-size: 14px;">Claim Item</a>
                    <a href="map.html" style="color: #777777; text-decoration: none; font-size: 14px;">Campus Map</a>
                </div>
            </div>
            <div>
                <div
                    style="font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: #888888; margin-bottom: 16px;">
                    Resources</div>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <a href="features.html" style="color: #777777; text-decoration: none; font-size: 14px;">Features</a>
                    <a href="sources.html" style="color: #777777; text-decoration: none; font-size: 14px;">Sources</a>
                </div>
            </div>
            <div>
                <div
                    style="font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: #888888; margin-bottom: 16px;">
                    Account</div>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <a href="login.html" style="color: #777777; text-decoration: none; font-size: 14px;">Log In</a>
                    <a href="signup.html" style="color: #777777; text-decoration: none; font-size: 14px;">Sign Up</a>
                    <a href="profile.html" style="color: #777777; text-decoration: none; font-size: 14px;">Profile</a>
                </div>
            </div>
        </div>
        <div
            style="display: flex; justify-content: space-between; align-items: center; padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.06); flex-wrap: wrap; gap: 12px;">
            <div style="color: #888888; font-size: 13px;">&copy; 2025â€“2026 BackTrack. Built for FBLA Coding &amp;
                Programming.</div>
            <div style="color: #888888; font-size: 13px;">Made by BackTrack Team</div>
        </div>
    </footer>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script>
        // DOM Elements
        const form = document.getElementById('submitForm');
        const uploadArea = document.getElementById('uploadArea');
        const imageInput = document.getElementById('imageInput');
        const imagePreview = document.getElementById('imagePreview');
        const previewImg = document.getElementById('previewImg');
        const removeImage = document.getElementById('removeImage');
        const submitBtn = document.getElementById('submitBtn');
        const successMessage = document.getElementById('successMessage');
        const pageBody = document.body;

        function updateNavBorder() {
            pageBody.classList.toggle('nav-scrolled', window.scrollY > 4);
        }

        let selectedFile = null;
        let selectedImageDataUrl = '';

        // Set default date to today
        const today = new Date();
        const formattedDate = today.toISOString().split('T')[0];
        document.getElementById('itemDate').value = formattedDate;
        updateNavBorder();
        window.addEventListener('scroll', updateNavBorder, { passive: true });

        // Upload area click
        uploadArea.addEventListener('click', () => imageInput.click());

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                handleImageSelect(file);
            }
        });

        // File input change
        imageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                handleImageSelect(file);
            }
        });

        // Handle image selection
        function handleImageSelect(file) {
            selectedFile = file;
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImg.src = e.target.result;
                selectedImageDataUrl = e.target.result;
                uploadArea.style.display = 'none';
                imagePreview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        // Remove image
        removeImage.addEventListener('click', () => {
            selectedFile = null;
            selectedImageDataUrl = '';
            imageInput.value = '';
            previewImg.src = '';
            uploadArea.style.display = 'flex';
            imagePreview.style.display = 'none';
        });

        function readFileAsDataUrl(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = () => reject(new Error('Failed to read file'));
                reader.readAsDataURL(file);
            });
        }

        // ==========================================
        // DYNAMIC LOCATION MAPPING
        // ==========================================
        const locationMapping = {
            'Front Office / Admin': ['Front Office', 'Guidance'],
            'Cafeteria': ['Cafeteria'],
            'Media Center': ['Media Center'],
            'Gymnasium': ['Gymnasium', 'Weight Room'],
            'Classrooms': [
                'Room 101', 'Room 102', 'Room 103', 'Room 104', 'Room 105',
                'Room 106', 'Room 107', 'Room 108', 'Room 109', 'Room 201',
                'Room 202', 'Room 203', 'Room 204', 'Room 205', 'Room 206',
                'Room 207', 'Room 208', 'Room 209', 'Room 210', 'Room 211', 'Room 212'
            ],
            'Computer / Science Labs': ['Computer Lab', 'Science Lab 1', 'Science Lab 2'],
            'Art / Music Rooms': ['Art Room', 'Music Room'],
            'Restrooms': ['Restrooms'],
            'Athletic Fields / Track': ['Track & Stadium', 'Soccer Field', 'Baseball Field', 'Softball Field', 'Tennis Courts'],
            'Parking Lots / Bus Lot': ['Student Parking', 'Visitor Parking', 'Staff Parking', 'Bus Lot'],
            'The Barn': ['The Barn']
        };

        function setupLocationDependent(primaryId, specificId) {
            const primary = document.getElementById(primaryId);
            const specific = document.getElementById(specificId);

            primary.addEventListener('change', () => {
                const cat = primary.value;
                specific.innerHTML = '<option value="">Select Specific Location</option>';
                if (cat && locationMapping[cat] && locationMapping[cat].length > 1) {
                    specific.style.display = 'block';
                    specific.required = true;
                    locationMapping[cat].forEach(room => {
                        const opt = document.createElement('option');
                        opt.value = room;
                        opt.textContent = room;
                        specific.appendChild(opt);
                    });
                } else {
                    specific.style.display = 'none';
                    specific.required = false;
                }
            });
        }

        setupLocationDependent('itemLocation', 'itemLocationSpecific');
        setupLocationDependent('bountyLocation', 'bountyLocationSpecific');

        function getFinalLocation(primaryId, specificId) {
            const primary = document.getElementById(primaryId).value;
            const specific = document.getElementById(specificId);
            if (specific.style.display !== 'none' && specific.value) {
                return specific.value;
            } else if (primary && locationMapping[primary] && locationMapping[primary].length === 1) {
                return locationMapping[primary][0];
            }
            return primary;
        }

        // Form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Hide messages
            successMessage.classList.remove('show');

            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            try {
                if (typeof BackTrackDB !== 'undefined' && BackTrackDB.isSupabaseConfigured()) {
                    const user = await BackTrackDB.getCurrentUser();
                    if (!user) {
                        alert('Please log in to submit an item.');
                        window.location.href = 'login.html';
                        return;
                    }
                }

                let imageUrl = null;

                // Upload image if selected
                if (selectedFile) {
                    if (typeof BackTrackDB !== 'undefined') {
                        imageUrl = await BackTrackDB.uploadImage(selectedFile);
                    }
                    if (!imageUrl) {
                        imageUrl = selectedImageDataUrl || previewImg.src;
                    }
                    if (!imageUrl) {
                        imageUrl = await readFileAsDataUrl(selectedFile);
                    }
                } else if (selectedImageDataUrl) {
                    imageUrl = selectedImageDataUrl;
                }

                // Create item object
                const item = {
                    name: document.getElementById('itemName').value,
                    description: document.getElementById('itemDescription').value,
                    category: document.getElementById('itemCategory').value,
                    location: getFinalLocation('itemLocation', 'itemLocationSpecific'),
                    date_lost: document.getElementById('itemDate').value,
                    image_url: imageUrl,
                    finder_name: document.getElementById('finderName').value,
                    contact_email: document.getElementById('contactEmail').value,
                    contact_phone: document.getElementById('contactPhone').value,
                    status: 'pending'
                };

                // Check if Supabase is configured
                if (typeof BackTrackDB !== 'undefined' && BackTrackDB.isSupabaseConfigured()) {
                    // Add to database
                    const result = await BackTrackDB.addItem(item);
                    if (!result) throw new Error('Failed to add item');
                }

                // Show success
                successMessage.classList.add('show');
                // Celebrate with confetti!
                if (window.BackTrackConfetti) {
                    window.BackTrackConfetti();
                }
                form.reset();
                document.getElementById('itemDate').value = formattedDate;
                removeImage.click();

                // Scroll to top to show success message
                window.scrollTo({ top: 0, behavior: 'smooth' });

            } catch (error) {
                console.error('Error submitting item:', error);
                alert(error.message || 'Something went wrong. Please try again.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit for Review';
            }
        });

        // ==========================================
        // TAB SWITCHING
        // ==========================================
        const tabFound = document.getElementById('tabFound');
        const tabBounty = document.getElementById('tabBounty');
        const panelFound = document.getElementById('panelFound');
        const panelBounty = document.getElementById('panelBounty');

        tabFound.addEventListener('click', () => {
            tabFound.classList.add('active');
            tabBounty.classList.remove('active');
            tabFound.setAttribute('aria-selected', 'true');
            tabBounty.setAttribute('aria-selected', 'false');
            panelFound.classList.add('active');
            panelBounty.classList.remove('active');
        });

        tabBounty.addEventListener('click', () => {
            tabBounty.classList.add('active');
            tabFound.classList.remove('active');
            tabBounty.setAttribute('aria-selected', 'true');
            tabFound.setAttribute('aria-selected', 'false');
            panelBounty.classList.add('active');
            panelFound.classList.remove('active');
        });

        // ==========================================
        // BOUNTY FORM
        // ==========================================
        const bountyForm = document.getElementById('bountyForm');
        const bountySubmitBtn = document.getElementById('bountySubmitBtn');
        const bountySuccessMsg = document.getElementById('bountySuccessMessage');
        const bountyUploadArea = document.getElementById('bountyUploadArea');
        const bountyImageInput = document.getElementById('bountyImageInput');
        const bountyImagePreview = document.getElementById('bountyImagePreview');
        const bountyPreviewImg = document.getElementById('bountyPreviewImg');
        const bountyRemoveImage = document.getElementById('bountyRemoveImage');

        let bountySelectedFile = null;
        let bountySelectedImageUrl = '';

        // Set bounty date default
        document.getElementById('bountyDate').value = formattedDate;

        // Bounty image upload
        bountyUploadArea.addEventListener('click', () => bountyImageInput.click());
        bountyUploadArea.addEventListener('dragover', (e) => { e.preventDefault(); bountyUploadArea.classList.add('dragover'); });
        bountyUploadArea.addEventListener('dragleave', () => bountyUploadArea.classList.remove('dragover'));
        bountyUploadArea.addEventListener('drop', (e) => {
            e.preventDefault(); bountyUploadArea.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) handleBountyImage(file);
        });
        bountyImageInput.addEventListener('change', (e) => { if (e.target.files[0]) handleBountyImage(e.target.files[0]); });

        function handleBountyImage(file) {
            bountySelectedFile = file;
            const reader = new FileReader();
            reader.onload = (e) => {
                bountyPreviewImg.src = e.target.result;
                bountySelectedImageUrl = e.target.result;
                bountyUploadArea.style.display = 'none';
                bountyImagePreview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        bountyRemoveImage.addEventListener('click', () => {
            bountySelectedFile = null; bountySelectedImageUrl = '';
            bountyImageInput.value = ''; bountyPreviewImg.src = '';
            bountyUploadArea.style.display = 'flex'; bountyImagePreview.style.display = 'none';
        });

        // Urgency buttons
        const urgencyBtns = document.querySelectorAll('.urgency-option');
        let selectedUrgency = 'low';
        urgencyBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                urgencyBtns.forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                selectedUrgency = btn.dataset.value;
            });
        });

        // Bounty submission
        bountyForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            bountySuccessMsg.classList.remove('show');
            bountySubmitBtn.disabled = true;
            bountySubmitBtn.textContent = 'Posting Bounty...';

            try {
                if (typeof BackTrackDB !== 'undefined' && BackTrackDB.isSupabaseConfigured()) {
                    const user = await BackTrackDB.getCurrentUser();
                    if (!user) {
                        alert('Please log in to post a bounty.');
                        window.location.href = 'login.html';
                        return;
                    }
                }

                let imageUrl = null;
                if (bountySelectedFile && typeof BackTrackDB !== 'undefined') {
                    imageUrl = await BackTrackDB.uploadImage(bountySelectedFile);
                }
                if (!imageUrl && bountySelectedImageUrl) imageUrl = bountySelectedImageUrl;

                const bounty = {
                    name: document.getElementById('bountyName').value,
                    description: document.getElementById('bountyDescription').value,
                    category: document.getElementById('bountyCategory').value,
                    location: getFinalLocation('bountyLocation', 'bountyLocationSpecific'),
                    date_lost: document.getElementById('bountyDate').value,
                    image_url: imageUrl,
                    contact_email: document.getElementById('bountyEmail').value,
                    contact_phone: document.getElementById('bountyPhone').value,
                    status: 'bounty',
                    is_bounty: true,
                    urgency: selectedUrgency
                };

                if (typeof BackTrackDB !== 'undefined' && BackTrackDB.isSupabaseConfigured()) {
                    const result = await BackTrackDB.addItem(bounty);
                    if (!result) throw new Error('Failed to post bounty');
                }

                bountySuccessMsg.classList.add('show');
                if (window.BackTrackConfetti) window.BackTrackConfetti();
                bountyForm.reset();
                document.getElementById('bountyDate').value = formattedDate;
                bountyRemoveImage.click();
                urgencyBtns.forEach(b => b.classList.remove('selected'));
                urgencyBtns[0].classList.add('selected');
                selectedUrgency = 'low';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } catch (error) {
                console.error('Error posting bounty:', error);
                alert(error.message || 'Something went wrong. Please try again.');
            } finally {
                bountySubmitBtn.disabled = false;
                bountySubmitBtn.textContent = 'Post Bounty';
            }
        });


        // Chatbot
        const chatbotToggle = document.getElementById('chatbotToggle');
        const chatbotPanel = document.getElementById('chatbotPanel');
        const chatbotClose = document.getElementById('chatbotClose');
        const chatbotMessages = document.getElementById('chatbotMessages');
        const chatbotInput = document.getElementById('chatbotInput');
        const chatbotSend = document.getElementById('chatbotSend');
        const chatbotStatus = document.getElementById('chatbotStatus');

        function setChatStatus(text, type) {
            if (!text) { chatbotStatus.textContent = ''; chatbotStatus.className = 'chatbot-status'; return; }
            chatbotStatus.textContent = text;
            chatbotStatus.className = `chatbot-status ${type || ''}`.trim();
        }

        function addChatMessage(text, role) {
            const message = document.createElement('div');
            message.className = `chatbot-message ${role || ''}`.trim();
            message.textContent = text;
            chatbotMessages.appendChild(message);
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }

        function toggleChat(open) { chatbotPanel.classList.toggle('open', open); }

        chatbotToggle.addEventListener('click', () => toggleChat(true));
        chatbotClose.addEventListener('click', () => toggleChat(false));

        const CHAT_SUPABASE_URL = window.BackTrackDB?.config?.url || 'YOUR_SUPABASE_PROJECT_URL';
        const CHAT_SUPABASE_ANON_KEY = window.BackTrackDB?.config?.anonKey || 'YOUR_SUPABASE_ANON_KEY';

        async function fetchChatbotReply(message) {
            if (!CHAT_SUPABASE_URL || !CHAT_SUPABASE_ANON_KEY || CHAT_SUPABASE_URL.includes('YOUR_SUPABASE')) {
                throw new Error('Supabase is not configured.');
            }
            const response = await fetch(`${CHAT_SUPABASE_URL}/functions/v1/chatbot`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', apikey: CHAT_SUPABASE_ANON_KEY, Authorization: `Bearer ${CHAT_SUPABASE_ANON_KEY}` },
                body: JSON.stringify({ message })
            });
            const payload = await response.json().catch(() => ({}));
            if (!response.ok) throw new Error(payload.error || `HTTP ${response.status}`);
            return payload.reply || '';
        }

        async function sendChat() {
            const text = chatbotInput.value.trim();
            if (!text) return;
            chatbotInput.value = '';
            addChatMessage(text, 'user');
            setChatStatus('');
            addChatMessage('Thinking...');
            const thinkingMessage = chatbotMessages.lastElementChild;
            try {
                const reply = await fetchChatbotReply(text);
                thinkingMessage.textContent = reply || 'No response received.';
            } catch (error) {
                setChatStatus('Chatbot error: ' + String(error), 'error');
                thinkingMessage.textContent = 'Sorry, something went wrong. Please try again.';
            }
        }

        chatbotSend.addEventListener('click', sendChat);
        chatbotInput.addEventListener('keydown', (event) => { if (event.key === 'Enter') sendChat(); });

        // Page transitions
        const pageTransition = document.getElementById('pageTransition');
        const transitionLinks = document.querySelectorAll('a[href$=".html"]');

        transitionLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                const href = link.getAttribute('href');
                if (href === window.location.pathname.split('/').pop() || href.startsWith('http')) return;

                e.preventDefault();
                pageTransition.classList.add('active');

                setTimeout(() => {
                    window.location.href = href;
                }, 400);
            });
        });
    </script>
    <script src="js/nav-auth.js"></script>
    <script src="js/accessibility.js"></script>
</body>

</html>